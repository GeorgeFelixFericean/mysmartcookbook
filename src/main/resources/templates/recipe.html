<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Detalii Rețetă</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #backButton {
            margin-top: 20px;
            padding: 10px;
            background: #007bff;
            color: white;
            border: none;
            cursor: pointer;
        }
        #backButton:hover {
            background: #0056b3;
        }
        .ingredient {
            margin-left: 20px;
        }
    </style>
</head>
<body>
<h2>Detalii Rețetă</h2>
<div id="recipeDetails"></div>

<button id="backButton">Înapoi la Home</button>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // 1. Obține ID-ul rețetei din URL (ex: /recipe/42)
        const path = window.location.pathname;    // /recipe/42
        const recipeId = path.substring(path.lastIndexOf("/") + 1);  // 42

        // 2. Apel la /api/recipes/{id} pentru datele rețetei
        fetch(`/api/recipes/${recipeId}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error("Rețetă inexistentă sau eroare la server.");
                }
                return response.json();
            })
            .then(recipe => {
                // 3. Afișează detaliile
                let detailsDiv = document.getElementById("recipeDetails");
                let htmlContent = `
                    <h3>${recipe.name}</h3>
                    <p><strong>Instrucțiuni:</strong> ${recipe.instructions || "N/A"}</p>
                    <p><strong>Observații:</strong> ${recipe.notes || "N/A"}</p>
                    <p><strong>Link Extern:</strong> ${recipe.externalLink || "-"}</p>
                    <p><strong>Imagine:</strong> ${recipe.imagePath || "-"}</p>
                    <h4>Ingrediente:</h4>
                    <ul>
                `;
                if (recipe.ingredients && recipe.ingredients.length > 0) {
                    recipe.ingredients.forEach(ing => {
                        htmlContent += `
                            <li class="ingredient">
                                ${ing.name} – ${ing.quantity} ${ing.unit}
                            </li>
                        `;
                    });
                } else {
                    htmlContent += "<li>Nicio ingredientă.</li>";
                }
                htmlContent += "</ul>";

                detailsDiv.innerHTML = htmlContent;
            })
            .catch(error => {
                document.getElementById("recipeDetails").innerHTML = `<p style="color:red">${error.message}</p>`;
            });

        // Butonul "Înapoi la Home"
        document.getElementById("backButton").addEventListener("click", function() {
            window.location.href = "/";
        });
    });
</script>
</body>
</html>
