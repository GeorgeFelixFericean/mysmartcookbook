<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalii Rețetă</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
          margin: 20px;
        }
        .recipe-container {
          max-width: 800px;
          margin: 0 auto;
        }
        .recipe-image {
          max-width: 100%;
          height: auto;
          border-radius: 5px;
        }
    </style>
</head>
<body>
<div class="recipe-container">
<!--    <h2>Detalii Rețetă</h2>-->
    <div id="recipeDetails"></div>
    <button id="backButton" class="btn btn-secondary mt-3">Înapoi la Home</button>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
      const path = window.location.pathname; // ex: /recipe/1
      const recipeId = path.substring(path.lastIndexOf("/") + 1);

      fetch(`/api/recipes/${recipeId}`)
        .then(response => {
          if (!response.ok) throw new Error("Rețetă inexistentă sau eroare la server.");
          return response.json();
        })
        .then(recipe => {
          let htmlContent = `
            <div class="card p-3 mb-3">
              <h3>${recipe.name}</h3>
              <p><strong>Instrucțiuni:</strong> ${recipe.instructions || "N/A"}</p>
              <p><strong>Observații:</strong> ${recipe.notes || "N/A"}</p>
              <p><strong>Link Extern:</strong> ${recipe.externalLink || "-"}</p>
          `;
          // Imagine
          if (recipe.imagePath) {
            htmlContent += `
              <img src="${recipe.imagePath}" alt="Imagine rețetă" class="recipe-image my-2">
            `;
          }

          // Ingrediente
          htmlContent += `<h5>Ingrediente:</h5><ul>`;
          if (recipe.ingredients && recipe.ingredients.length > 0) {
            recipe.ingredients.forEach(ing => {
              htmlContent += `<li>${ing.name} - ${ing.quantity} ${ing.unit}</li>`;
            });
          } else {
            htmlContent += `<li>Nicio ingredientă.</li>`;
          }
          htmlContent += `</ul></div>`;

          document.getElementById("recipeDetails").innerHTML = htmlContent;
        })
        .catch(error => {
          document.getElementById("recipeDetails").innerHTML = `<p style="color:red">${error.message}</p>`;
        });

      document.getElementById("backButton").addEventListener("click", function() {
        window.location.href = "/";
      });
    });
</script>
</body>
</html>
