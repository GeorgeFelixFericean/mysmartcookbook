<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Caută Rețete</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
<h2>Caută rețete</h2>

<!-- Căutare după nume -->
<div>
  <label for="searchByName">Căutare după nume:</label>
  <input type="text" id="searchByName" placeholder="Ex: pizza">
  <div id="suggestions" class="suggestions-box"></div>
</div>

<!-- Căutare după ingrediente -->
<div>
  <label for="searchIngredients">Căutare după ingrediente (separate prin virgulă):</label>
  <input type="text" id="searchIngredients" placeholder="Ex: faina,apa,drojdie">
  <button onclick="searchByIngredients()">Caută</button>
</div>

<div id="searchResults"></div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/js/scripts.js"></script>
<script>
  // Autocomplete pentru căutarea după nume
  $("#searchByName").on("input", function() {
    let query = $(this).val();
    if (query.length > 1) {
      $.ajax({
        url: "/api/recipes/search-by-name",
        type: "GET",
        data: { name: query },
        success: function(data) {
          let suggestions = $("#suggestions");
          suggestions.empty().show();
          if (data.length === 0) {
            suggestions.append("<div class='suggestion-item'>Nicio sugestie</div>");
          } else {
            data.forEach(recipe => {
              suggestions.append(`<div class='suggestion-item' onclick="goToRecipe(${recipe.id})">${recipe.name}</div>`);
            });
          }
        }
      });
    } else {
      $("#suggestions").hide();
    }
  });

  // Ascunde sugestiile dacă dai click în afara lor
  $(document).click(function(e) {
    if (!$(e.target).closest("#searchByName, #suggestions").length) {
      $("#suggestions").hide();
    }
  });
</script>
</body>
</html>
